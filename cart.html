<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Products Browse</title>
                <link rel="stylesheet" href="buy.css">
                    <link rel="stylesheet" href="buycard.css">
                        <link rel="stylesheet" href="sidebar.css">
                            <link rel="stylesheet" href="checkout.css">
                               <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
                                  </head>

                                     <body>
                                          <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
                                               

                                                       <div class="CartContainer">
                                                          	   <div class="Header">
                                                                    	   	<h3 class="Heading">My Cart | Checkout</h3>
                                                                                  	   	<h5 class="Action">Remove all</h5>
                                                                                                	   </div>
                                                                                                             <div class="table-products">
                                                                                                                     
                                                                                                                         
                                                                                                                            	   
                                                                                                                                      	   </div>
                                                                                                                                                	 <hr> 
                                                                                                                                                        	 <div class="checkout">
                                                                                                                                                                	 <div class="total">
                                                                                                                                                                        	 	<div>
                                                                                                                                                                                    	 		<div class="Subtotal">Total</div>
                                                                                                                                                                                                    	 		<div class="items">Refresh</div>
                                                                                                                                                                                                                    	 	</div>
                                                                                                                                                                                                                                	 	<div class="total-amount">â‚¹</div> 
                                                                                                                                                                                                                                            	 </div>
                                                                                                                                                                                                                                                    	 <button class="button">Checkout</button></div>
                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                               <script>
                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       </script>
                                                                                                                                                                                                                                                                          </div>
                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                          <div class="table-products">
                                                                                                                                                                                                                                                                                                  <tr>

                                                                                                                                                                                                                                                                                                          </tr>
                                                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                                                                    <script>
                                                                                                                                                                                                                                                                                                                          const UserSpot = localStorage.UserSpot;
                                                                                                                                                                                                                                                                                                                              </script>
                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                  <!-- The core Firebase JS SDK is always required and must be listed first -->

                                                                                                                                                                                                                                                                                                                                    <script src="https://www.gstatic.com/firebasejs/7.21.0/firebase-app.js"></script>

                                                                                                                                                                                                                                                                                                                                      <!-- TODO: Add SDKs for Firebase products that you want to use

                                                                                                                                                                                                                                                                                                                                            https://firebase.google.com/docs/web/setup#available-libraries -->

                                                                                                                                                                                                                                                                                                                                              <script src="https://www.gstatic.com/firebasejs/7.21.0/firebase-firestore.js"></script>
                                                                                                                                                                                                                                                                                                                                                 <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-storage.js"></script>
                                                                                                                                                                                                                                                                                                                                                   <script>

                                                                                                                                                                                                                                                                                                                                                       // Your web app's Firebase configuration

                                                                                                                                                                                                                                                                                                                                                           var firebaseConfig = {

                                                                                                                                                                                                                                                                                                                                                               apiKey: "AIzaSyDPbCB9o3c44_KqEcTL8PrPXvOioNI9Skw",

                                                                                                                                                                                                                                                                                                                                                                   authDomain: "netizen-70f7b.firebaseapp.com",

                                                                                                                                                                                                                                                                                                                                                                       databaseURL: "https://netizen-70f7b-default-rtdb.asia-southeast1.firebasedatabase.app",
                                                                                                                                                                                                                                                                                                                                                                           projectId: "netizen-70f7b",
                                                                                                                                                                                                                                                                                                                                                                               storageBucket: "netizen-70f7b.appspot.com",
                                                                                                                                                                                                                                                                                                                                                                                   messagingSenderId: "900442479711",
                                                                                                                                                                                                                                                                                                                                                                                       appId: "1:900442479711:web:8fe818cd16e8feeaff8fea",
                                                                                                                                                                                                                                                                                                                                                                                            measurementId: "G-G8XQQBBY8F"
                                                                                                                                                                                                                                                                                                                                                                                                };

                                                                                                                                                                                                                                                                                                                                                                                                    // Initialize Firebase

                                                                                                                                                                                                                                                                                                                                                                                                        firebase.initializeApp(firebaseConfig);

                                                                                                                                                                                                                                                                                                                                                                                                            const db = firebase.firestore();
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                  </script>
                                                                                                                                                                                                                                                                                                                                                                                                                    <script>
                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                        const tableCart = document.querySelector('.table-products');
                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                            const FinalPrice = document.querySelector('.total-amount');
                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                console.log("Reading");
                                                                                                                                                                                                                                                                                                                                                                                                                                  

                                                                                                                                                                                                                                                                                                                                                                                                                                    var FinalRate = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                      // Create element and render products

                                                                                                                                                                                                                                                                                                                                                                                                                                      const renderCart = doc => {
                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                         let str = doc.data().Product;

                                                                                                                                                                                                                                                                                                                                                                                                                                         let after = str.substring(str.indexOf('â‚¹') + 1);

                                                                                                                                                                                                                                                                                                                                                                                                                                         FinalRate = FinalRate + Number(after);

                                                                                                                                                                                                                                                                                                                                                                                                                                         sessionStorage.setItem("FinalRate", FinalRate);
                                                                                                                                                                                                                                                                                                                                                                                                                                         //setTimeout('', 5000);

                                                                                                                                                                                                                                                                                                                                                                                                                                         console.log(after); //  only price
                                                                                                                                                                                                                                                                                                                                                                                                                                         console.log(FinalRate);


                                                                                                                                                                                                                                                                                                                                                                                                                                           const tr = `
                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                              	   <div class="Cart-Items pad">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   <!--
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  	   	  <div class="image-box">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  	   	  	<img src="${doc.data().Imagesrc}"/>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      	   	  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      	   	-->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	   	
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  	   	
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	   	  <div class="about">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	   	  	<h1 class="title">${doc.data().Product}</h1>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	   	  	
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  	
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	   	  	<!--
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	   	  	<h3 class="subtitle">${doc.data().BrandName} | ${doc.data().BrandNameLang}</h3>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	   	  	-->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  <div class="counter">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  	<div class="btn">+</div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	   	  	<div class="count">1</div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	   	  	<div class="btn">-</div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	   	  	<div class="btn">Ã—</div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  <div class="prices">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  <!--
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	   	  	<div class="amount">â‚¹${doc.data().Price}</div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	   	  	-->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	   	  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	   </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          	   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               `;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       tableCart.insertAdjacentHTML('beforeend', tr);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           }


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           db.collection("users").doc(localStorage.userId).collection('cart').onSnapshot(snapshot => {

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             snapshot.docChanges().forEach(change => {

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 if (change.type === 'added') {

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       renderCart(change.doc);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               if (change.type === 'removed') {

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     let tr = document.querySelector(`[data-id='${change.doc.id}']`);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           let tbody = tc.parentElement;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 tableCart.removeChild(tbody);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         if (change.type === 'modified') {

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               let tr = document.querySelector(`[data-id='${change.doc.id}']`);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     let tbody = tr.parentElement;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           tableCart.removeChild(tbody);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 renderCart(change.doc);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       })

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       function FinalPriceShow(){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         //FinalPrice.innerHTML = "";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           FinalPrice.insertAdjacentHTML('beforeend', sessionStorage.FinalRate);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   <script src="db.js"></script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               FinalPriceShow();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       const btn = document.querySelector('#checkOut');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          btn.addEventListener('click', () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               document.documentElement.classList.toggle('checked-out');     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </body>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             